<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Where's the Element? - 周期表クイズ</title>
<style>
/* 全体レイアウト */
body { 
    font-family: 'Helvetica Neue', Arial, sans-serif; 
    text-align: center; 
    background: #f8f9fa; 
    margin: 0; 
    padding: 10px;
    color: #333;
}
h1 { font-size: 1.5rem; margin-bottom: 10px; }

/* コントロールエリア */
.controls {
    background: white;
    padding: 15px;
    border-radius: 10px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    margin-bottom: 20px;
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
}
select { padding: 8px; font-size: 16px; border-radius: 5px; border: 1px solid #ccc; }
#score { margin: 10px 0; font-weight: bold; color: #555; font-size: 0.9rem; }
#question { 
    font-size: 1.2rem; 
    margin: 15px 0; 
    padding: 10px; 
    background: #e9ecef; 
    border-radius: 5px;
    min-height: 1.5em;
}

/* 周期表のコンテナ（スマホでのスクロール対応） */
.table-wrapper {
    overflow-x: auto;
    padding: 10px;
    -webkit-overflow-scrolling: touch;
}

/* 周期表のグリッド設定 */
#ptable {
    display: grid;
    /* 1列目(周期番号用) + 18列(元素用) */
    grid-template-columns: 30px repeat(18, 55px);
    grid-auto-rows: 55px;
    gap: 4px;
    justify-content: center;
    margin: 0 auto;
    min-width: 1050px; /* 全要素を表示するための最小幅 */
}

/* セルの基本スタイル */
.cell {
    background: #fff;
    border: 1px solid #dee2e6;
    border-radius: 4px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    font-size: 11px;
    transition: all 0.2s;
    user-select: none;
}
.cell:hover { background: #f1f3f5; transform: translateY(-2px); box-shadow: 0 4px 6px rgba(0,0,0,0.1); }

/* 族・周期番号のラベル用セル */
.label-cell {
    background: none;
    border: none;
    color: #888;
    font-weight: bold;
    font-size: 12px;
    cursor: default;
}
.label-cell:hover { transform: none; box-shadow: none; background: none; }

/* 特殊状態 */
.correct { background: #51cf66 !important; color: white; border-color: #40c057; }
.wrong { background: #ff6b6b !important; color: white; border-color: #fa5252; }
.empty { background: transparent; border: none; cursor: default; }
.empty:hover { transform: none; box-shadow: none; }

/* 記号を強調 */
.symbol { font-weight: bold; font-size: 14px; }

/* レスポンシブ調整 */
@media (max-width: 600px) {
    h1 { font-size: 1.2rem; }
    #question { font-size: 1rem; }
}
</style>
</head>
<body>

<div class="controls">
    <h1>Where’s the Element?</h1>
    <label>レベル：
        <select id="level">
            <option value="1">中学レベル</option>
            <option value="2">高校レベル</option>
            <option value="3">全元素</option>
        </select>
    </label>
    <div id="score">正答数: 0 / 0 | 連続正解: 0 | 正答率: 0%</div>
    <div id="question">読み込み中...</div>
</div>

<div class="table-wrapper">
    <div id="ptable"></div>
</div>

<script>
const allElements = [
    {symbol:"H", name:"水素", period:1, group:1},
    {symbol:"He", name:"ヘリウム", period:1, group:18},
    {symbol:"Li", name:"リチウム", period:2, group:1},
    {symbol:"Be", name:"ベリリウム", period:2, group:2},
    {symbol:"B", name:"ホウ素", period:2, group:13},
    {symbol:"C", name:"炭素", period:2, group:14},
    {symbol:"N", name:"窒素", period:2, group:15},
    {symbol:"O", name:"酸素", period:2, group:16},
    {symbol:"F", name:"フッ素", period:2, group:17},
    {symbol:"Ne", name:"ネオン", period:2, group:18},
    {symbol:"Na", name:"ナトリウム", period:3, group:1},
    {symbol:"Mg", name:"マグネシウム", period:3, group:2},
    {symbol:"Al", name:"アルミニウム", period:3, group:13},
    {symbol:"Si", name:"ケイ素", period:3, group:14},
    {symbol:"P", name:"リン", period:3, group:15},
    {symbol:"S", name:"硫黄", period:3, group:16},
    {symbol:"Cl", name:"塩素", period:3, group:17},
    {symbol:"Ar", name:"アルゴン", period:3, group:18},
    {symbol:"K", name:"カリウム", period:4, group:1},
    {symbol:"Ca", name:"カルシウム", period:4, group:2},
    {symbol:"Sc", name:"スカンジウム", period:4, group:3},
    {symbol:"Ti", name:"チタン", period:4, group:4},
    {symbol:"V", name:"バナジウム", period:4, group:5},
    {symbol:"Cr", name:"クロム", period:4, group:6},
    {symbol:"Mn", name:"マンガン", period:4, group:7},
    {symbol:"Fe", name:"鉄", period:4, group:8},
    {symbol:"Co", name:"コバルト", period:4, group:9},
    {symbol:"Ni", name:"ニッケル", period:4, group:10},
    {symbol:"Cu", name:"銅", period:4, group:11},
    {symbol:"Zn", name:"亜鉛", period:4, group:12},
    {symbol:"Ga", name:"ガリウム", period:4, group:13},
    {symbol:"Ge", name:"ゲルマニウム", period:4, group:14},
    {symbol:"As", name:"ヒ素", period:4, group:15},
    {symbol:"Se", name:"セレン", period:4, group:16},
    {symbol:"Br", name:"臭素", period:4, group:17},
    {symbol:"Kr", name:"クリプトン", period:4, group:18},
    {symbol:"Rb", name:"ルビジウム", period:5, group:1},
    {symbol:"Sr", name:"ストロンチウム", period:5, group:2},
    {symbol:"Y",  name:"イットリウム", period:5, group:3},
    {symbol:"Zr", name:"ジルコニウム", period:5, group:4},
    {symbol:"Nb", name:"ニオブ", period:5, group:5},
    {symbol:"Mo", name:"モリブデン", period:5, group:6},
    {symbol:"Tc", name:"テクネチウム", period:5, group:7},
    {symbol:"Ru", name:"ルテニウム", period:5, group:8},
    {symbol:"Rh", name:"ロジウム", period:5, group:9},
    {symbol:"Pd", name:"パラジウム", period:5, group:10},
    {symbol:"Ag", name:"銀", period:5, group:11},
    {symbol:"Cd", name:"カドミウム", period:5, group:12},
    {symbol:"In", name:"インジウム", period:5, group:13},
    {symbol:"Sn", name:"スズ", period:5, group:14},
    {symbol:"Sb", name:"アンチモン", period:5, group:15},
    {symbol:"Te", name:"テルル", period:5, group:16},
    {symbol:"I",  name:"ヨウ素", period:5, group:17},
    {symbol:"Xe", name:"キセノン", period:5, group:18},
    {symbol:"Cs", name:"セシウム", period:6, group:1},
    {symbol:"Ba", name:"バリウム", period:6, group:2},
    {symbol:"Lan", name:"Lan", period:6, group:3}, 
    {symbol:"Hf", name:"ハフニウム", period:6, group:4},
    {symbol:"Ta", name:"タンタル", period:6, group:5},
    {symbol:"W", name:"タングステン", period:6, group:6},
    {symbol:"Re", name:"レニウム", period:6, group:7},
    {symbol:"Os", name:"オスミウム", period:6, group:8},
    {symbol:"Ir", name:"イリジウム", period:6, group:9},
    {symbol:"Pt", name:"白金", period:6, group:10},
    {symbol:"Au", name:"金", period:6, group:11},
    {symbol:"Hg", name:"水銀", period:6, group:12},
    {symbol:"Tl", name:"タリウム", period:6, group:13},
    {symbol:"Pb", name:"鉛", period:6, group:14},
    {symbol:"Bi", name:"ビスマス", period:6, group:15},
    {symbol:"Po", name:"ポロニウム", period:6, group:16},
    {symbol:"At", name:"アスタチン", period:6, group:17},
    {symbol:"Rn", name:"ラドン", period:6, group:18},
    {symbol:"Fr", name:"フランシウム", period:7, group:1},
    {symbol:"Ra", name:"ラジウム", period:7, group:2},
    {symbol:"Act", name:"Act", period:7, group:3},
    {symbol:"Rf", name:"ラザホージウム", period:7, group:4},
    {symbol:"Db", name:"ドブニウム", period:7, group:5},
    {symbol:"Sg", name:"シーボーギウム", period:7, group:6},
    {symbol:"Bh", name:"ボーリウム", period:7, group:7},
    {symbol:"Hs", name:"ハッシウム", period:7, group:8},
    {symbol:"Mt", name:"マイトネリウム", period:7, group:9},
    {symbol:"Ds", name:"ダームスタチウム", period:7, group:10},
    {symbol:"Rg", name:"レントゲニウム", period:7, group:11},
    {symbol:"Cn", name:"コペルニシウム", period:7, group:12},
    {symbol:"Nh", name:"ニホニウム", period:7, group:13},
    {symbol:"Fl", name:"フレロビウム", period:7, group:14},
    {symbol:"Mc", name:"モスコビウム", period:7, group:15},
    {symbol:"Lv", name:"リバモリウム", period:7, group:16},
    {symbol:"Ts", name:"テネシン", period:7, group:17},
    {symbol:"Og", name:"オガネソン", period:7, group:18}
];

// レベル1：中学（主要20元素 + 馴染みのある金属）
const level1 = [
    "H","He","C","N","O","F","Ne","Na","Mg","Al","Si","P","S","Cl","Ar","K","Ca",
    "Fe","Cu","Zn","Ag","Au","Hg","Ba","I"
];

// レベル2：高校（第4周期まで全制覇 + 受験頻出元素）
const level2 = level1.concat([
    "Li","Be","B", // 1-20の残り
    "Sc","Ti","V","Cr","Mn","Co","Ni","Ga","Ge","As","Se","Br","Kr", // 第4周期完成
    "Sn","Pb","Pt", // 重要な重金属
]);
const level3 = allElements.filter(e => e.symbol !== "Lan" && e.symbol !== "Act").map(e=>e.symbol);

let correctCount=0, totalCount=0, streak=0, currentLevel = 1, questionElement=null;

const ptable = document.getElementById("ptable");

function initTable() {
    ptable.innerHTML = "";
    
    // 0行目: 族番号ラベル (1-18)
    const emptyTopLeft = document.createElement("div");
    emptyTopLeft.classList.add("cell", "label-cell");
    ptable.appendChild(emptyTopLeft);

    for(let g=1; g<=18; g++) {
        const groupLabel = document.createElement("div");
        groupLabel.classList.add("cell", "label-cell");
        groupLabel.innerText = g;
        ptable.appendChild(groupLabel);
    }

    // 1-7行目: 周期番号ラベル + 元素セル
    for(let p=1; p<=7; p++){
        // 周期ラベル
        const periodLabel = document.createElement("div");
        periodLabel.classList.add("cell", "label-cell");
        periodLabel.innerText = p;
        ptable.appendChild(periodLabel);

        for(let g=1; g<=18; g++){
            const cell = document.createElement("div");
            cell.classList.add("cell");
            const el = allElements.find(e=>e.period===p && e.group===g);
            
            if(el){
                if(el.symbol === "Lan" || el.symbol === "Act") {
                    cell.classList.add("empty");
                    cell.innerText = p === 6 ? "La系" : "Ac系";
                } else {
                    cell.dataset.symbol = el.symbol;
                    cell.innerHTML = `<span class="symbol">${el.symbol}</span><span>${el.name}</span>`;
                    cell.addEventListener("click",()=>checkAnswer(el.symbol,cell));
                }
            }else{
                cell.classList.add("empty");
            }
            ptable.appendChild(cell);
        }
    }
}

document.getElementById("level").addEventListener("change", e=>{
    currentLevel=parseInt(e.target.value);
    nextQuestion();
});

function getLevelSymbols(){
    if(currentLevel===1) return level1;
    if(currentLevel===2) return level2;
    return level3;
}

function nextQuestion(){
    const candidates = getLevelSymbols();
    const randomSymbol = candidates[Math.floor(Math.random()*candidates.length)];
    questionElement = allElements.find(e=>e.symbol===randomSymbol);
    document.getElementById("question").innerText = `「${questionElement.name} (${questionElement.symbol})」の場所は？`;
}

function checkAnswer(symbol, cell){
    if(!questionElement) return;
    totalCount++;
    if(symbol===questionElement.symbol){
        correctCount++;
        streak++;
        cell.classList.add("correct");
        setTimeout(()=>cell.classList.remove("correct"),500);
    } else {
        streak = 0;
        cell.classList.add("wrong");
        setTimeout(()=>cell.classList.remove("wrong"),500);

        const allCells = document.querySelectorAll('.cell');
        const correctCell = Array.from(allCells).find(c => c.dataset.symbol === questionElement.symbol);
        if(correctCell){
            correctCell.classList.add("correct");
            setTimeout(()=>correctCell.classList.remove("correct"),1000);
        }
    }
    updateScore();
    setTimeout(nextQuestion,800);
}

function updateScore(){
    const rate = totalCount===0?0:Math.round((correctCount/totalCount)*100);
    document.getElementById("score").innerText = `正答数: ${correctCount} / ${totalCount} | 連続正解: ${streak} | 正答率: ${rate}%`;
}

initTable();
nextQuestion();
</script>
</body>
</html>

